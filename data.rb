# frozen_string_literal: true

# chrono-manager: codegeass.ru chronology manager.
# Copyright (c) 2019 Sumeragi Kaguya <nyalice _at_ technologist.com>
#
# This program is free software: you can redistribute it and/or modify it under
# the terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <https://www.gnu.org/licenses/>.

require 'time'

ARCS = {
  0 => nil,
  1 => DateTime.new(2017, 7, 14, 23),
  2 => DateTime.new(2017, 9, 1),
  3 => DateTime.new(2017, 10, 1),
  4 => DateTime.new(2017, 10, 16),
  5 => DateTime.new(2017, 11, 1),
  6 => DateTime.new(2017, 12, 1),
  7 => DateTime.new(2018, 1, 1)
}.freeze

CHARS = {
  1 => 'Лелуш ви Британия',
  2 => 'Милли Эшфорд',
  3 => 'Каллен Стадтфилд',
  4 => 'С.С.',
  5 => 'Сузаку Куруруги',
  6 => 'Шарли Фенетт',
  7 => 'Наннали ви Британия',
  8 => 'Алекс Блэкмор',
  9 => 'Куро Татсумаки',
  10 => 'Ллойд Асплунд',
  11 => 'Ренли ла Британия',
  12 => 'Ингрид Блэкмейн',
  13 => 'Эллеонора МакКонелл',
  14 => 'Джаселина Кейн',
  15 => 'Джеремия Готтвальд',
  16 => 'Ривалз Кардемонд',
  17 => 'Аннет Хэнгроуф',
  18 => 'Юфемия ли Британия',
  19 => 'Джилл Валентайн',
  20 => 'Нина Эйнштейн',
  21 => 'Макс Рейнс',
  22 => 'Майкл С. Коллинз',
  23 => 'Элизабет Хэрлифилд',
  24 => 'Джулиан Кейн',
  25 => 'Вергилия вар Британия',
  26 => 'Александр Крестовский',
  27 => 'Руслана Хмельницкая',
  28 => 'Такаи Садао',
  29 => 'Владимир Макаров',
  30 => 'Андрэ Мюллер',
  31 => 'Генри Олкотт',
  32 => 'Ева Лоудон',
  33 => 'Аня Алстрейм',
  34 => 'Шнайзель эль Британия',
  35 => 'Канон Мальдини',
  36 => 'Гвиневра су Британия',
  37 => 'Ракшата Чаула',
  38 => 'Цай Гао',
  39 => 'Оливер Даррел',
  40 => 'Корнелия ли Британия',
  41 => 'Катя Вальдхейм',
  42 => 'Эрика Лито',
  43 => 'Альва Фальк',
  44 => 'Эдвард МакМиллан',
  45 => 'Лейла Малкаль',
  46 => 'Ли Синке',
  47 => 'Дочь Неба',
  48 => 'Одиссей ю Британия',
  49 => 'Кагуя Сумераги',
  50 => 'Кристиан Девет',
  51 => 'Эмилия Кларк',
  52 => 'Гай Андерсон',
  53 => 'Исматулла аль Муад’Диб',
  54 => 'Шиничиро Тамаки',
  55 => 'Милинда Брантини',
  56 => 'Валериан ла Британия',
  57 => 'Виктория Беллерос',
  58 => "Рианнон О'Нейл",
  59 => 'Гвендолин Андерсон',
  60 => 'Якоб Фрай-Йохансон',
  61 => 'Сын Неба',
  62 => 'Иен Рэннер',
  63 => 'Акито Хьюга',
  64 => 'N.N.',
  65 => 'Элисон Луденберк',
  66 => 'Макс Шейд',
  67 => 'Артур',
  68 => 'Роло Халибартон',
  69 => 'Анна Некрасова',
  70 => 'Мирцелла мэл Британия',
  71 => 'Дункан Кэмпбелл',
  72 => 'Джино Вайнберг',
  73 => 'Ганнибал Бота',
  74 => 'Чарльз зи Британия',
  75 => 'Ральф Виттманн',
  76 => 'Конрад Штерн',
  77 => 'Джоан Уортингтон-Хоггарт',
  78 => 'Элизабет Ривер',
  79 => 'Хильда Курцман',
  80 => 'Драйк цу Тотенсееле',
  81 => 'Юджин Винтер',
  82 => 'Эмма Кёниг',
  83 => 'Густав Вольф',
  84 => 'Манфред Рихтер',
  85 => 'Кейтилин фон Хафтен',
  86 => 'Канаме Огги',
  87 => 'Анна Клемент',
  88 => 'Франциско Диаз',
  89 => 'Алиса Мальченко',
  90 => 'Станислав Мальченко',
  91 => 'Дмитрий Щукин',
  92 => 'Алекс Нойманн',
  93 => 'Фридрих Краузе',
  94 => 'Роман Малолин',
  95 => 'Евгений Красов',
  96 => 'Алина Тихомирова',
  97 => 'Елена Миклушова',
  98 => 'Василиса Михеева',
  99 => 'Джеймс Блэкмейн',
  100 => 'Лувиягелита ди Британия',
  101 => 'Оскар Хаммель',
  102 => 'Винсент Кэмпбелл',
  103 => 'Митт Траун',
  104 => 'Алисия Дрискол',
  105 => 'Сунь Джиан',
  106 => 'Лин-Инь Хуань',
  107 => 'Антон Сaндерс',
  108 => 'Гилберт Гилфорд',
  109 => 'Лонг Бей',
  110 => 'Вэй Дзин',
  111 => 'Лилиана Вергамон',
  112 => 'Хоу Мэй',
  113 => 'Маррибелл мэл Британия',
  114 => 'Габриэль фон Британия',
  115 => 'Олдрин Зевон',
  116 => 'Рунольв Льётсон',
  117 => 'Сан Лиан',
  118 => 'Вилетта Ню',
  119 => 'Лиллиан фар Британия',
  120 => 'Сильвия фар Британия',
  121 => 'Акено Ходзимэ',
  122 => 'Сайто Ходзимэ',
  123 => 'Хоу Шан',
  124 => 'Дарья Филатова',
  125 => 'Джун Ли',
  126 => "Коналл О'Дохерти",
  127 => 'Рик Занков',
  128 => 'Фейт Уоллер',
  129 => 'Анжела Лаврова',
  130 => 'Хайн Рамштайнер',
  131 => 'Максим Мерко',
  132 => 'Денис Снегирёв',
  133 => 'Кримхильд Гретчен',
  134 => 'Джи Киуо',
  135 => 'Хоу Тинсянь',
  136 => 'Леонхардт Стейнер',
  137 => 'Павел Чернов',
  138 => 'Себастиан Зогу',
  139 => 'Корнелиус Календа',
  140 => 'Юлия Крылова',
  141 => 'Катарина Рихтер',
  142 => 'Ксиу Лан',
  143 => 'Татьяна Чернова',
  144 => 'Меинард Ассман',
  145 => 'Ренэйт Тэресия',
  146 => 'Элайза Дэй',
  147 => 'Феликс Семеренко',
  148 => 'Сесиль Круми',
  149 => 'Курт фон Книспель',
  150 => 'Микола Вишневецький',
  151 => 'Киоширо Тодо',
  152 => 'Манфред Бота',
  153 => 'Джим Стенфорд',
  154 => 'Рай Коллорс',
  155 => 'Эльза Кригер',
  156 => 'Эрих Хельденхафт',
  157 => 'Грицько Короленко',
  158 => 'Бертрам Фрост',
  159 => 'Рауль Менендез',
  160 => 'Николь Беро',
  161 => 'Джеймс Нарой',
  162 => 'Кассандра Бота',
  163 => 'Элеонора МакДи',
  164 => 'Лотарь Бота',
  165 => 'Луиджи Джильди',
  166 => 'Хайнрих фон Нойбайтен',
  167 => 'Лучано Брэдли',
  168 => 'Алексей Дегтярёв',
  169 => 'Тиль Ойленшпигель',
  170 => 'Ая Уокер',
  171 => 'Фриц Биттенфельд',
  172 => 'Флориан Бертайн',
  173 => 'Сой Фонг',
  174 => 'Михаэла Вальц',
  175 => 'Анжелика Айнштюрцен',
  176 => 'Магдалена Фюрст',
  177 => 'Карл Райнер Воллен',
  178 => 'Пол Апперстоун',
  179 => 'Шарлотта Лафоре',
  180 => 'Алексей Романов',
  181 => 'Андрей Громов',
  182 => 'Александра Романова',
  183 => 'Сергей Воронов',
  184 => 'Анна Шмидт',
  185 => 'Елизавета Романова',
  186 => 'Серафима Орлова',
  188 => 'Павел Романов',
  189 => 'Карин нэ Британия',
  190 => 'Сергей Крестовский',
  191 => 'Гвеневера Эйнсворт',
  192 => 'Виктория Храброва',
  193 => 'Астрид Фонтейн',
  194 => 'Валентин Потапов',
  195 => 'Светлана Аксакова',
  196 => 'Дитхард Рид',
  197 => 'Олег Стуков',
  198 => 'Илкер Берк Гюлер',
  199 => 'Жоланна Дьюит',
  200 => 'Тиалания тэль Британия',
  201 => 'Хинт Морган',
  202 => 'Альбина Хилл',
  203 => 'Константин Бондаренко',
  204 => 'Морган Мортимер',
  205 => 'Алан Рэмси',
  206 => 'Дмитрий Вишневецкий',
  207 => 'Братислав',
  208 => 'Андрей Стогов',
  209 => 'Джек',
  210 => 'Арториас Артуа',
  211 => 'Пьер де Вейль',
  212 => 'Симидзу Нозоми',
  213 => 'Диего Монтойя',
  214 => 'Лилия Потапова',
  215 => 'Накамура Татсуми',
  216 => 'Эмия Атсуко',
  217 => 'Такатсуки Рейджи',
  218 => 'Николай Чернов',
  219 => 'Михаил Башкатов',
  220 => 'Джессика Хаксли',
  221 => 'Наото Кодзуки',
  222 => 'Майя Байерн',
  223 => 'Ванесса Мэй',
  224 => 'Рикардо Альварес',
  225 => 'Карл Кронен',
  226 => 'Стивен Лайтинг',
  227 => 'Эмили Лайтинг',
  228 => 'Хенрик Йегер',
  229 => 'Катхал Бранна',
  230 => 'Александра Новых',
  231 => 'Фридрих фон Шиллер',
  232 => 'Александра Цейдлер',
  233 => 'Листрит де Франс',
  234 => 'Кобураги Котецу',
  235 => 'Артур Уэлсли',
  236 => 'Рубен Кастер Эшфорд',
  237 => 'Эмилия Густав',
  238 => 'Ямаат Угэдэй',
  239 => 'Элис Блекберри',
  240 => 'Лея Иствинд',
  241 => 'Иннокентий Киров',
  242 => 'Никита Некрасов',
  243 => 'Сольф Кимбли',
  244 => 'Цао Чжэнь',
  245 => 'Кловис ла Британия',
  246 => 'Брунгильда',
  247 => 'Нонетт Эннеаграм',
  248 => 'Николас Холт',
  249 => 'Чарли Оуэн',
  250 => 'Мао',
  251 => 'Аззазель Левиафан',
  252 => 'Ричард де Вер',
  253 => 'Алексей Ланской',
  254 => 'Варвара Соболева',
  255 => 'Тереза Левандовски',
  256 => 'Ляо Ши',
  257 => 'Мария Вуйцик',
  258 => 'Мима',
  259 => 'Марика Сореси',
  260 => 'Шин (Хьюга) Шэйнг',
  261 => 'Инна Юдакова',
  262 => 'Никита Лавров',
  263 => 'Виктор Кравченко',
  264 => 'Чэн Байху',
  265 => 'Иван Полозов',
  266 => 'Гуна Рокошева',
  267 => 'Джек Доу',
  268 => 'Фредерик Леннокс',
  269 => 'Лакшми Тришна Неру',
  270 => 'Адам ДеКобрэй',
  271 => 'Диана Кэмпбелл',
  272 => 'Винсент Дарклиф',
  273 => 'Марианна ви Британия',
  274 => 'Александр Медведев',
  276 => 'Андрей Вороненко',
  277 => 'София Эльтнова',
  278 => 'Бен Кламски',
  279 => 'Мартин де Мендата',
  280 => 'Минерва рей Британия',
  281 => 'Гуан Янлин',
  282 => 'Элени Смирнова',
  283 => 'Шарам Наджи',
  284 => 'Честер Корпленд',
  285 => 'Амос Блейк',
  286 => 'Слэйн Диланди',
  287 => 'Гарен Стоунхарт',
  288 => 'Лейф Бергистрём',
  289 => 'Артур Леман',
  290 => 'Урсула Димитриди',
  291 => 'Алисия Блэк',
  292 => 'Эммерих Мейер',
  293 => 'Райден',
  294 => 'Карл Густав Миттермайер',
  295 => 'Эрна Фелиция Нахтигаль',
  296 => 'Бисмарк Валдштейн',
  297 => 'Константин Чацкий',
  298 => 'Люй Бувэй',
  299 => 'Габриэлла ла Британия',
  300 => 'Ким Сайрумов',
  301 => 'Вэйн Штрансзберг',
  302 => 'Астрид Гудбранд',
  303 => 'Такаи Хару',
  304 => 'Екатерина Юрьевская',
  305 => 'Пьер Эжен Мао'
}.freeze
CHARS_BACK = CHARS.invert.merge(
  "Рианнон О'Нейл" => 58,
  'Emiya Atsuko' => 216,
  'Emmerich Meyer' => 292,
  'M.M.' => 258,
  'N.N' => 64,
  'Wayne Stranszberg' => 301,
  'Александр Крестовский' => 26,
  'Алексей Ланской' => 253,
  'Анжела Лаврова' => 129,
  'Анна Клемент' => 87,
  'Аня Альстрейм' => 33,
  'Астрид Гудбранд' => 302,
  'Бен Кламски' => 278,
  'Владимир Макаров' => 29,
  'Гвиневра су Британия' => 36,
  'Джино Вайнберг' => 72,
  'Дункан Кэмпбелл' => 71,
  'Зеро' => 1,
  'Иван Полозов' => 265,
  'Кагуя Сумераги' => 49,
  'Каллен Кодзуки' => 3,
  'Каллен Козуки' => 3,
  'Карин нэ Британия' => 189,
  'Кассандра Бота' => 162,
  'Ким Сайрумов' => 300,
  'Кловис ла Британия' => 245,
  'Командующий Кобра' => 270,
  'Константин Уайт' => 297,
  'Ллойд Асплунд' => 10,
  'Лучиано Брэдли' => 167,
  'Марианна Британская' => 273,
  'Марианна ви Британия' => 273,
  'Марика Сореси' => 259,
  'Мария Вуйцик' => 257,
  'Миллай' => 2,
  'Мима' => 258,
  'Митт Траун' => 103,
  'Наннали' => 7,
  'Одиссей ю Британия' => 48,
  'Павел Романов' => 188,
  'Пьер Мао' => 305,
  'Пьер Эжен Мао' => 305,
  'Ренли ла Британия' => 11,
  'Сесиль Круми' => 148,
  'Сольф Кимбли' => 243,
  'Соня Эльтнова' => 277,
  'Станислав Мальченко' => 90,
  'Тянцзы' => 47,
  'Чарльз Британский' => 74,
  'Чарльз зи Британия' => 74,
  'Шарли Фенетт' => 6,
  'Элис Блекберри' => 239,
  'Элис' => 239,
  'Эмия Атсуко' => 216
).freeze

TIMEZONES = {
  'Пендрагон' => 0,
  'Нео-Токио' => 16,
  'Рим, Ватикан' => 8,
  'СБИ, 11 сектор' => 16,
  'Российская Империя, Москва' => 10,
  'Москва' => 10,
  'Санкт-Петербург' => 10,
  'Павлодар' => 13,
  'Сальвадор, Бразилия' => 1,
  '11 сектор' => 16,
  'Священная Британская Империя, 11 сектор' => 16,
  'Восточный Тимор' => 15,
  'Евросоюз, Франция' => 8,
  'Франция' => 8,
  'Мадагаскар' => 10,
  'Британия, герцогство Висконсин' => 1,
  'Висконсин' => 1,
  'Претория' => 9,
  'Евросоюз, Российская Империя, Выборг' => 10,
  'Китай' => 15,
  'Индия, Дели' => 12,
  'Гонконг' => 15,
  'Кронштадт' => 10,
  'Колумбия' => 2,
}.freeze
